

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Part 1: BW4T skeleton &mdash; MATRXS 0.0.1 Manual 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> MATRXS 0.0.1 Manual
          

          
            
            <img src="../../_static/matrxslogo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../aboutmatrxs.html">About MATRXS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/installing.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQ.html">F.A.Q.</a></li>
</ul>
<p class="caption"><span class="caption-text">Sections</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../sections/worlds.html">Worlds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/actions.html">Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/brains.html">Brains</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/objects.html">Object placement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/simgoals.html">Simulation goals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/utils.html">Utils</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MATRXS 0.0.1 Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Part 1: BW4T skeleton</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/about/tutorials/bw4t_part1.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="part-1-bw4t-skeleton">
<h1>Part 1: BW4T skeleton<a class="headerlink" href="#part-1-bw4t-skeleton" title="Permalink to this headline">¶</a></h1>
<p>In this series of tutorials, we will create the scenario of two agents co-operating to find, grab and deliver a certain sequence
of blocks. The two agents are autonomous, thus no human agents are involved in these tutorials. We will cover the implementation
of the block-gathering agent brain, and handle the communication between the two agents. Basic actions like building a
world and adding objects and agents to the world are assumed to be prior knowledge for this creating this scenario.</p>
<p>In this scenario, there are 4 rooms, each containing a certain color of blocks. Each room contains one door. The agents
cannot see what is inside a room before the door is opened. Together, the agents have to deliver a sequence of blocks
to a designated delivery area. The sequence is specified by the user. Once all blocks in the sequence have successfully
been delivered, the simulation is over. Another version of this scenario is when the rooms contain several blocks which do
not have the same color. This requires some tweaking of the situation described in this tutorial. Check the MATRXS repository
for an example of ‘randomly’ colored blocks in rooms.</p>
<p>The image below shows what the scene created during the tutorial looks like. Having trouble building this world? Check
the basic tutorials <a class="reference internal" href="create_world_factory.html#creating-your-matrxs-world"><span class="std std-ref">Creating your MATRXS world</span></a> and <a class="reference internal" href="adding_objects.html#adding-objects"><span class="std std-ref">Adding objects</span></a>. Important for this particular solution
to solving the block sequence delivery is to name the rooms in the scenario according to the color of blocks the room
contains. In other words: make sure the word ‘red’ is in your room name when the room contains red blocks. The same goes
for the doors and blocks.</p>
<a class="reference internal image-reference" href="../../_images/BW4T_start.png"><img alt="An image showing the initial state of the teaming task." src="../../_images/BW4T_start.png" style="width: 400px;" /></a>
<div class="section" id="brain-initialization">
<h2>Brain initialization<a class="headerlink" href="#brain-initialization" title="Permalink to this headline">¶</a></h2>
<p>After having created the objects in the scenario, it is time to add the block-gathering agents. We will do so by creating
a new .py file in the MATRXS folder ‘agents’. The skeleton of this agent brain contains the class initialization, the
method for filtering observations, and the method for deciding on an action. See ‘AgentBrain’ in Section <a class="reference internal" href="../../sections/brains.html#brains"><span class="std std-ref">Brains</span></a> for
an overview of methods used in an agent’s brain.</p>
<p>While initializing the brain, we create a state tracker to build the agent’s memory, a navigator to cleverly move the
agent over the area, and we make sure that the agent knows what to do; what action to perform next for the given color.
We can divide the separate actions an agent has to perform in this task as follows:</p>
<ul class="simple">
<li><p>The agent has to find the room that contains the required block. In this scenario, the block color is indicated in the object names. For example, ‘red_room’ contains red blocks.</p></li>
<li><p>Once the appropriate room has been found, the corresponding door has to be opened.</p></li>
<li><p>The open door causes new information to appear in the agent’s memory, namely the blocks and their location within the room. The agent now has to search the room for the location of one of the blocks.</p></li>
<li><p>Once the agent is in the correct position, it can grab a block.</p></li>
<li><p>While carrying the block, the agent moves to the drop-off area.</p></li>
<li><p>The block is dropped once the agent has reached the drop-off area.</p></li>
<li><p>If the entire sequence of blocks has been delivered, the agent does nothing.</p></li>
</ul>
<p>In the snippet below, an example initialization is given.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="bp">self</span><span class="o">.</span><span class="n">state_tracker</span> <span class="o">=</span> <span class="n">StateTracker</span><span class="p">(</span><span class="n">agent_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agent_id</span><span class="p">)</span>

<span class="bp">self</span><span class="o">.</span><span class="n">navigator</span> <span class="o">=</span> <span class="n">Navigator</span><span class="p">(</span><span class="n">agent_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agent_id</span><span class="p">,</span> <span class="n">action_set</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">action_set</span><span class="p">,</span>
                           <span class="n">algorithm</span><span class="o">=</span><span class="n">Navigator</span><span class="o">.</span><span class="n">A_STAR_ALGORITHM</span><span class="p">)</span>

<span class="bp">self</span><span class="o">.</span><span class="n">goal_cycle</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;find_room&quot;</span><span class="p">,</span> <span class="s2">&quot;open_door&quot;</span><span class="p">,</span> <span class="s2">&quot;search_room&quot;</span><span class="p">,</span> <span class="s2">&quot;grab_block&quot;</span><span class="p">,</span> <span class="s2">&quot;to_dropoff&quot;</span> <span class="p">,</span><span class="s2">&quot;drop_block&quot;</span><span class="p">,</span> <span class="s2">&quot;done&quot;</span><span class="p">]</span>

<span class="bp">self</span><span class="o">.</span><span class="n">block_orders</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="filtering-observations">
<h2>Filtering observations<a class="headerlink" href="#filtering-observations" title="Permalink to this headline">¶</a></h2>
<p>Depending on what you want your agents to be able to perceive, the method for filtering observations can be implemented.
In the case of this BlocksWorld task, we assume the only constraint is that agents cannot see into rooms if the door has not been
opened. The idea of the method is that an adapted copy of the current state gets returned as the next state. This adaptation
is, in this case, the removal of items within a room of which the door has not been opened yet. If the door has been opened,
the items within the room become known to the agent(s) and stay in their memory of the state.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">filter_observations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filtering the agent&#39;s observations.</span>
<span class="sd">    :param state:</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_state</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">closed_room_colors</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="s1">&#39;door@&#39;</span> <span class="ow">in</span> <span class="n">k</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;is_open&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">closed_room_colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">closed_room_colors</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">color</span> <span class="ow">in</span> <span class="n">k</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;doormat&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">k</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;block&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">):</span>
                <span class="n">new_state</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">state_tracker</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_state</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_state</span>
</pre></div>
</div>
</div>
<div class="section" id="action-execution">
<h2>Action execution<a class="headerlink" href="#action-execution" title="Permalink to this headline">¶</a></h2>
<p>The main part wanting to implement a BlocksWorld scenario is, of course, knowing how to implement agents’ behaviour. The
behaviour is implemented in the method ‘decide_on_action’. In this method, we define all objects that are of interest to
an agent’s actions. We also provide other practicalities, such as keeping track of the current goal and of the other
agent(s). The method returns the action the agent should perform at the current time point in the simulation, followed by
any variable values, if needed. In the next part of this tutorial series, you can find how exactly the currently discussed
BlocksWorld agent brain has been implemented.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, The MATRXS Team at TNO.nl

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    

  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #303030;
    }
    /* Sidebar */
    .wy-nav-side {
      background: #578a64;
    }
  </style>


</body>
</html>